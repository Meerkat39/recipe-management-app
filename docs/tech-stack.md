# レシピ管理アプリケーション - 技術スタック選定書

## 📋 採用技術一覧

### MVP (Phase 1) で使用する技術

| カテゴリ | 技術 | バージョン | 用途 |
|----------|------|------------|------|
| **フレームワーク** | Next.js | 15.x | フロントエンド・API開発 |
| **言語** | TypeScript | 5.x | 型安全な開発 |
| **スタイリング** | Tailwind CSS | 4.x | UIスタイリング |
| **データベース** | SQLite | - | 開発環境データ保存 |
| **ORM** | Prisma | 5.x | データベース操作 |
| **バリデーション** | Zod | 3.x | 入力データ検証 |
| **状態管理** | React Hooks | - | クライアント状態管理 |
| **リンター** | ESLint | 8.x | コード品質チェック |
| **フォーマッター** | Prettier | 3.x | コード整形 |
| **デプロイ** | Vercel | - | ホスティング・CI/CD |

### 将来の拡張予定技術

| Phase | 技術 | 用途 |
|-------|------|------|
| **2A** | PostgreSQL | 本番データベース |
| **2A** | shadcn/ui | UIコンポーネント |
| **2A** | React Hook Form | フォーム管理 |
| **2B** | Zustand | 状態管理 |
| **2B** | NextAuth.js | 認証システム |
| **3** | Redis | キャッシュ |

## 🎯 技術選定の方針

### 選定基準
- **学習効率**: 新しい技術を効率的に習得できる
- **開発速度**: MVP を短期間で構築できる
- **将来性**: 長期的な保守・拡張に対応できる
- **エコシステム**: 豊富なライブラリとコミュニティサポート
- **型安全性**: バグを早期発見し、品質を向上できる

## 📚 採用技術スタック

### フロントエンド

#### ⚛️ Next.js 15 (App Router)
**選定理由**
- **React ベース**: 豊富なエコシステムと学習リソース
- **App Router**: 最新のファイルベースルーティング
- **Server Actions**: フォーム送信とサーバー処理の統合
- **SSR/SSG**: SEO とパフォーマンスの最適化
- **API Routes**: バックエンド機能も統合可能
- **Vercel 統合**: 簡単なデプロイメント

**Server Actions 活用**
- フォーム送信の直接的なサーバー処理
- クライアント・サーバー間のシームレスな連携
- TypeScript による型安全なデータフロー

**代替案との比較**
| 技術 | メリット | デメリット | 選択理由 |
|------|----------|------------|----------|
| **Next.js 15** | フルスタック対応、最新機能 | 学習コストやや高 | ✅ 総合的なバランス |
| Vite + React | 高速開発、軽量 | バックエンド別途必要 | ❌ 構成が複雑 |
| Nuxt.js | Vue.js エコシステム | React より小さなコミュニティ | ❌ 学習リソース少 |

#### 🎨 TypeScript
**選定理由**
- **型安全性**: コンパイル時のエラー検出
- **開発効率**: IDE サポートと自動補完
- **保守性**: 大規模開発での可読性向上
- **エコシステム**: Next.js との親和性

#### 🎨 Tailwind CSS v4
**選定理由**
- **開発速度**: ユーティリティファーストでの高速スタイリング
- **一貫性**: デザインシステムの統一
- **レスポンシブ**: モバイルファースト設計
- **カスタマイズ性**: 柔軟な設定とテーマ対応

**代替案との比較**
| 技術 | メリット | デメリット | 選択理由 |
|------|----------|------------|----------|
| **Tailwind CSS** | 高速開発、一貫性 | HTML が冗長になる | ✅ MVP に最適 |
| CSS Modules | スコープ分離 | 命名とファイル管理 | ❌ 開発速度劣る |
| styled-components | CSS-in-JS | ランタイムオーバーヘッド | ❌ パフォーマンス劣る |

### バックエンド・データベース

#### 🗄️ Prisma ORM
**選定理由**
- **型安全性**: TypeScript との完全統合
- **マイグレーション**: スキーマ変更の管理
- **クエリビルダー**: 直感的な API
- **デベロッパーエクスペリエンス**: 優秀な IDE サポート

#### 🐘 SQLite → PostgreSQL
**選定理由**
- **SQLite (開発環境)**
  - セットアップ不要
  - ローカル開発に最適
  - ファイルベースで軽量
- **PostgreSQL (本番環境)**
  - 高性能・高機能
  - JSON サポート
  - Vercel Postgres 対応

**代替案との比較**
| 技術 | メリット | デメリット | 選択理由 |
|------|----------|------------|----------|
| **Prisma + PostgreSQL** | 型安全、高機能 | 学習コスト | ✅ 長期的な価値 |
| Drizzle ORM | 軽量、高速 | エコシステム小 | ❌ 情報不足 |
| Raw SQL | 直接制御 | 型安全性なし | ❌ 開発効率悪 |

### バリデーション・データ検証

#### 🛡️ Zod
**選定理由**
- **TypeScript ファースト**: 型推論との連携
- **ランタイムバリデーション**: 実行時の型安全性
- **スキーマ定義**: 宣言的なバリデーション
- **エラーハンドリング**: 詳細なエラーメッセージ

**代替案との比較**
| 技術 | メリット | デメリット | 選択理由 |
|------|----------|------------|----------|
| **Zod** | TS統合、直感的API | やや重い | ✅ 開発体験最高 |
| Yup | 豊富な機能 | TS統合弱い | ❌ 型安全性劣る |
| Joi | 成熟した API | TS統合なし | ❌ TypeScript 未対応 |

### UI コンポーネント・状態管理

#### 🎭 React Hooks (useState, useEffect)
**選定理由**
- **シンプル性**: MVP に必要十分な機能
- **学習容易性**: React 標準機能
- **軽量**: 追加ライブラリ不要

**Phase 2 での拡張候補**
- **Zustand**: 軽量状態管理
- **React Query**: サーバー状態管理
- **React Hook Form**: フォーム管理

#### 🧩 shadcn/ui (将来検討)
**Phase 2 での採用理由**
- **カスタマイズ性**: Tailwind CSS ベース
- **アクセシビリティ**: WCAG 準拠
- **コピー&ペースト**: ライブラリ依存なし

### 開発・デプロイメント

#### 🚀 Vercel
**選定理由**
- **Next.js 最適化**: 開発元による最適化
- **自動デプロイ**: Git 連携でのCI/CD
- **エッジ配信**: グローバルなパフォーマンス
- **無料枠**: MVP 開発に十分

#### 📝 ESLint + Prettier
**選定理由**
- **コード品質**: 統一されたコーディング規約
- **自動修正**: 開発効率の向上
- **チーム開発**: 一貫したコードスタイル

## 🗺️ アーキテクチャ構成

### システム構成図
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │   Backend       │    │   Database      │
│   (Next.js)     │    │   (API Routes)  │    │   (SQLite/PG)   │
├─────────────────┤    ├─────────────────┤    ├─────────────────┤
│ • React         │◄──►│ • Next.js API   │◄──►│ • Prisma Client │
│ • TypeScript    │    │ • Zod Validation│    │ • SQLite (dev)  │
│ • Tailwind CSS  │    │ • Prisma Service│    │ • PostgreSQL    │
│ • React Hooks   │    │ • Error Handler │    │   (production)  │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 │
                    ┌─────────────────┐
                    │   Deployment    │
                    │   (Vercel)      │
                    ├─────────────────┤
                    │ • Auto Deploy   │
                    │ • Edge Network  │
                    │ • Environment   │
                    │   Variables     │
                    └─────────────────┘
```

### データフロー
```
User Input → Zod Validation → API Routes → Prisma Service → Database
                                   ↓
User Interface ← React Components ← JSON Response ← API Response
```

## 📦 package.json 依存関係

### 本番依存関係
```json
{
  "dependencies": {
    "next": "^15.0.0",
    "react": "^18.0.0",
    "react-dom": "^18.0.0",
    "@prisma/client": "^5.0.0",
    "zod": "^3.22.0",
    "clsx": "^2.0.0",
    "tailwind-merge": "^2.0.0"
  }
}
```

### 開発依存関係
```json
{
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@types/react": "^18.0.0",
    "@types/react-dom": "^18.0.0",
    "prisma": "^5.0.0",
    "typescript": "^5.0.0",
    "tailwindcss": "^4.0.0",
    "eslint": "^8.0.0",
    "eslint-config-next": "^15.0.0",
    "prettier": "^3.0.0",
    "autoprefixer": "^10.0.0",
    "postcss": "^8.0.0"
  }
}
```

## 🔄 Phase 別技術採用計画

### Phase 1 (MVP: 現在)
- ✅ Next.js + TypeScript + Tailwind
- ✅ Prisma + SQLite
- ✅ Zod バリデーション
- ✅ React Hooks のみ

### Phase 2A (基本拡張)
- 🔄 PostgreSQL 移行
- 🔄 shadcn/ui 採用
- 🔄 React Hook Form
- 🔄 画像アップロード (Cloudinary)

### Phase 2B (機能拡張)
- 🔄 Zustand (状態管理)
- 🔄 React Query (サーバー状態)
- 🔄 NextAuth.js (認証)

### Phase 3 (高度な機能)
- 🔄 Redis (キャッシュ)
- 🔄 Elasticsearch (全文検索)
- 🔄 Docker (コンテナ化)

## ⚡ パフォーマンス・最適化戦略

### フロントエンド最適化
- **コード分割**: Dynamic imports
- **画像最適化**: Next.js Image コンポーネント
- **バンドル最適化**: Tree shaking
- **キャッシュ戦略**: SWR パターン

### バックエンド最適化
- **データベース**: インデックス最適化
- **クエリ**: N+1 問題の回避
- **レスポンス**: JSON 最適化
- **セキュリティ**: Input validation

## 🔒 セキュリティ考慮事項

### 入力検証
- **Zod スキーマ**: すべての入力データ検証
- **SQL インジェクション**: Prisma による防御
- **XSS 対策**: React の自動エスケープ

### 認証・認可 (Phase 2B)
- **NextAuth.js**: 認証システム
- **JWT**: セッション管理
- **RBAC**: ロールベースアクセス制御

この技術スタックにより、効率的で保守性の高いレシピ管理アプリケーションを構築できます。
